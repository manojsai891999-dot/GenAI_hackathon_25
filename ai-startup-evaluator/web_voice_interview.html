<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Voice Interview - AI Startup Evaluator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .interview-container {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 40px;
            max-width: 800px;
            width: 90%;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
        }

        .header {
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #fff, #f0f0f0);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .status-indicator {
            display: inline-block;
            padding: 10px 20px;
            border-radius: 25px;
            margin: 10px;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .status-waiting {
            background: rgba(255, 193, 7, 0.3);
            border: 2px solid #ffc107;
        }

        .status-listening {
            background: rgba(220, 53, 69, 0.3);
            border: 2px solid #dc3545;
            animation: pulse 1.5s infinite;
        }

        .status-speaking {
            background: rgba(40, 167, 69, 0.3);
            border: 2px solid #28a745;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        .conversation-area {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            min-height: 300px;
            max-height: 400px;
            overflow-y: auto;
            text-align: left;
        }

        .message {
            margin: 15px 0;
            padding: 15px;
            border-radius: 10px;
            animation: fadeIn 0.5s ease;
        }

        .interviewer-message {
            background: rgba(0, 123, 255, 0.3);
            border-left: 4px solid #007bff;
        }

        .founder-message {
            background: rgba(40, 167, 69, 0.3);
            border-left: 4px solid #28a745;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .controls {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .btn-primary {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
        }

        .btn-success {
            background: linear-gradient(45deg, #28a745, #1e7e34);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(45deg, #dc3545, #c82333);
            color: white;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .analysis-panel {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            text-align: left;
        }

        .analysis-item {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 10px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 8px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #28a745, #20c997);
            transition: width 0.5s ease;
        }

        .founder-info {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }

        .microphone-icon {
            font-size: 3em;
            margin: 20px 0;
            opacity: 0.7;
        }

        .listening-animation {
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            60% { transform: translateY(-5px); }
        }
    </style>
</head>
<body>
    <div class="interview-container">
        <div class="header">
            <h1>üé§ Live Voice Interview</h1>
            <div class="founder-info">
                <h3>üë§ Founder: <span id="founderName">Syed Ubedulla Khadri</span></h3>
                <h3>üè¢ Startup: <span id="startupName">TechInnovate Solutions</span></h3>
            </div>
            <div id="statusIndicator" class="status-indicator status-waiting">
                üîÑ Initializing Interview System...
            </div>
        </div>

        <div class="conversation-area" id="conversationArea">
            <div class="message interviewer-message">
                <strong>üé§ AI Interviewer:</strong> Welcome! I'm preparing to start your voice interview. Please make sure your microphone and speakers are working.
            </div>
        </div>

        <div class="microphone-icon" id="microphoneIcon">üéôÔ∏è</div>

        <div class="controls">
            <button class="btn btn-primary" id="startBtn" onclick="startInterview()">
                üöÄ Start Voice Interview
            </button>
            <button class="btn btn-success" id="speakBtn" onclick="startListening()" disabled>
                üéôÔ∏è Speak Now
            </button>
            <button class="btn btn-danger" id="stopBtn" onclick="stopInterview()" disabled>
                ‚èπÔ∏è Stop Interview
            </button>
        </div>

        <div class="analysis-panel">
            <h3>üìä Real-time Analysis</h3>
            <div class="analysis-item">
                <span>üéØ Current Topic:</span>
                <span id="currentTopic">Introduction</span>
            </div>
            <div class="analysis-item">
                <span>ü§ù Rapport Level:</span>
                <span id="rapportLevel">0.5</span>
            </div>
            <div class="analysis-item">
                <span>üìà Progress:</span>
                <span id="progressPercent">0%</span>
            </div>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill" style="width: 0%"></div>
            </div>
            <div class="analysis-item">
                <span>üí° Key Insights:</span>
                <span id="keyInsights">None yet</span>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let recognition;
        let synthesis;
        let isListening = false;
        let isSpeaking = false;
        let interviewActive = false;
        let currentExchange = 0;
        let sessionData = {
            sessionId: `voice_interview_${Date.now()}`,
            founderName: "Syed Ubedulla Khadri",
            startupName: "TechInnovate Solutions",
            currentTopic: "introduction",
            rapportLevel: 0.5,
            conversationHistory: [],
            insightsGathered: {}
        };

        // Interview questions and flow
        const interviewFlow = {
            introduction: {
                question: `Hi ${sessionData.founderName}! Thanks for joining me today. I'm really excited to learn about ${sessionData.startupName} and what you're building. This will be a natural conversation where we'll explore your business in detail. To get started, could you tell me a bit about yourself and what inspired you to start ${sessionData.startupName}? What problem are you solving?`,
                nextTopic: "business_model"
            },
            business_model: {
                question: "That's fascinating! Now I'd love to understand the business mechanics better. How exactly do you make money? What's your revenue model and pricing strategy?",
                nextTopic: "market_opportunity"
            },
            market_opportunity: {
                question: "That business model sounds solid! Now I'm curious about the market you're targeting. How big is this opportunity? Who are your main competitors and how do you differentiate from them?",
                nextTopic: "traction_metrics"
            },
            traction_metrics: {
                question: "The market opportunity sounds compelling! Let's talk about your traction. What does your growth look like? Can you share some key metrics or customer success stories?",
                nextTopic: "team_execution"
            },
            team_execution: {
                question: "Those are encouraging numbers! Tell me about the team behind this success. What's your background? Who are your co-founders? How are you thinking about scaling the team?",
                nextTopic: "funding_vision"
            },
            funding_vision: {
                question: `Sounds like you have a strong foundation! Looking ahead, what are your funding needs? How much are you raising and what will you use it for? What's your long-term vision for ${sessionData.startupName}?`,
                nextTopic: "conclusion"
            },
            conclusion: {
                question: `That's an exciting vision! Before we wrap up, what questions do you have for me? What would you like to know about our investment process?`,
                nextTopic: "end"
            }
        };

        // Initialize speech recognition and synthesis
        function initializeSpeech() {
            // Speech Recognition
            if ('webkitSpeechRecognition' in window) {
                recognition = new webkitSpeechRecognition();
            } else if ('SpeechRecognition' in window) {
                recognition = new SpeechRecognition();
            } else {
                alert('Speech recognition not supported in this browser. Please use Chrome or Edge.');
                return false;
            }

            recognition.continuous = false;
            recognition.interimResults = false;
            recognition.lang = 'en-US';

            recognition.onstart = function() {
                isListening = true;
                updateStatus('üéôÔ∏è Listening...', 'status-listening');
                document.getElementById('microphoneIcon').classList.add('listening-animation');
            };

            recognition.onresult = function(event) {
                const transcript = event.results[0][0].transcript;
                processFounderResponse(transcript);
            };

            recognition.onerror = function(event) {
                console.error('Speech recognition error:', event.error);
                updateStatus('‚ùå Speech recognition error. Try again.', 'status-waiting');
                isListening = false;
                document.getElementById('microphoneIcon').classList.remove('listening-animation');
            };

            recognition.onend = function() {
                isListening = false;
                document.getElementById('microphoneIcon').classList.remove('listening-animation');
                if (interviewActive) {
                    updateStatus('üîÑ Processing your response...', 'status-waiting');
                }
            };

            // Speech Synthesis
            synthesis = window.speechSynthesis;

            return true;
        }

        // Start the interview
        function startInterview() {
            if (!initializeSpeech()) return;

            interviewActive = true;
            currentExchange = 0;
            
            document.getElementById('startBtn').disabled = true;
            document.getElementById('speakBtn').disabled = false;
            document.getElementById('stopBtn').disabled = false;

            updateStatus('üé§ Interview Started!', 'status-speaking');
            
            // Start with introduction
            const introQuestion = interviewFlow.introduction.question;
            speakQuestion(introQuestion);
        }

        // Speak a question
        function speakQuestion(text) {
            isSpeaking = true;
            updateStatus('üîä AI Speaking...', 'status-speaking');
            
            addMessage('interviewer', text);

            const utterance = new SpeechSynthesisUtterance(text);
            utterance.rate = 0.9;
            utterance.pitch = 1;
            utterance.volume = 0.9;

            // Try to use a professional voice
            const voices = synthesis.getVoices();
            const preferredVoice = voices.find(voice => 
                voice.name.includes('Google') || 
                voice.name.includes('Microsoft') ||
                voice.lang.includes('en')
            );
            if (preferredVoice) {
                utterance.voice = preferredVoice;
            }

            utterance.onend = function() {
                isSpeaking = false;
                if (interviewActive) {
                    updateStatus('üëÇ Your turn to speak!', 'status-waiting');
                    document.getElementById('speakBtn').disabled = false;
                }
            };

            synthesis.speak(utterance);
        }

        // Start listening for founder response
        function startListening() {
            if (!isListening && !isSpeaking && interviewActive) {
                document.getElementById('speakBtn').disabled = true;
                recognition.start();
            }
        }

        // Process founder's response
        function processFounderResponse(response) {
            addMessage('founder', response);
            
            // Analyze response
            const analysis = analyzeResponse(response);
            updateAnalysis(analysis);
            
            // Add to conversation history
            sessionData.conversationHistory.push({
                timestamp: new Date().toISOString(),
                speaker: 'founder',
                content: response,
                analysis: analysis
            });

            // Generate next question
            setTimeout(() => {
                generateNextQuestion(analysis);
            }, 1000);
        }

        // Analyze founder's response
        function analyzeResponse(response) {
            const wordCount = response.split(' ').length;
            
            // Simple sentiment analysis
            const positiveWords = ['excited', 'fantastic', 'great', 'amazing', 'successful', 'growing', 'confident'];
            const negativeWords = ['challenging', 'difficult', 'struggling', 'worried', 'problem'];
            
            const positiveCount = positiveWords.filter(word => 
                response.toLowerCase().includes(word)
            ).length;
            
            const negativeCount = negativeWords.filter(word => 
                response.toLowerCase().includes(word)
            ).length;
            
            let sentimentScore = 0.5;
            if (positiveCount + negativeCount > 0) {
                sentimentScore = positiveCount / (positiveCount + negativeCount);
            }
            
            // Extract insights
            const insights = {};
            const businessKeywords = {
                revenue: ['revenue', 'money', 'sales', 'profit'],
                customers: ['customers', 'clients', 'users'],
                team: ['team', 'founder', 'employees'],
                growth: ['growth', 'growing', 'scale']
            };
            
            for (const [category, keywords] of Object.entries(businessKeywords)) {
                if (keywords.some(keyword => response.toLowerCase().includes(keyword))) {
                    insights[category] = true;
                }
            }
            
            // Update rapport
            if (sentimentScore > 0.7 && wordCount > 30) {
                sessionData.rapportLevel = Math.min(sessionData.rapportLevel + 0.1, 1.0);
            }
            
            return {
                wordCount,
                sentimentScore,
                insights,
                qualityScore: Math.min(wordCount / 50, 1.0) * 0.6 + sentimentScore * 0.4
            };
        }

        // Generate next question
        function generateNextQuestion(analysis) {
            const currentFlow = interviewFlow[sessionData.currentTopic];
            
            if (!currentFlow || currentFlow.nextTopic === 'end') {
                // End interview
                const closingMessage = `Thank you so much for this conversation, ${sessionData.founderName}! This has been really insightful learning about ${sessionData.startupName}. We'll review everything and be in touch with next steps within 48 hours. I'm excited about what you're building!`;
                speakQuestion(closingMessage);
                
                setTimeout(() => {
                    stopInterview();
                }, 5000);
                return;
            }
            
            // Move to next topic
            sessionData.currentTopic = currentFlow.nextTopic;
            const nextQuestion = interviewFlow[sessionData.currentTopic].question;
            
            // Add enthusiasm based on response quality
            let enthusiasm = "";
            if (analysis.sentimentScore > 0.7) {
                enthusiasm = "That's fantastic! ";
            } else if (analysis.sentimentScore > 0.5) {
                enthusiasm = "That's interesting! ";
            }
            
            const fullQuestion = enthusiasm + nextQuestion;
            
            setTimeout(() => {
                speakQuestion(fullQuestion);
            }, 2000);
        }

        // Update status indicator
        function updateStatus(text, className) {
            const indicator = document.getElementById('statusIndicator');
            indicator.textContent = text;
            indicator.className = `status-indicator ${className}`;
        }

        // Add message to conversation
        function addMessage(speaker, text) {
            const conversationArea = document.getElementById('conversationArea');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${speaker}-message`;
            
            const speakerIcon = speaker === 'interviewer' ? 'üé§' : 'üë§';
            const speakerName = speaker === 'interviewer' ? 'AI Interviewer' : sessionData.founderName;
            
            messageDiv.innerHTML = `<strong>${speakerIcon} ${speakerName}:</strong> ${text}`;
            
            conversationArea.appendChild(messageDiv);
            conversationArea.scrollTop = conversationArea.scrollHeight;
        }

        // Update analysis panel
        function updateAnalysis(analysis) {
            document.getElementById('currentTopic').textContent = sessionData.currentTopic.replace('_', ' ').toUpperCase();
            document.getElementById('rapportLevel').textContent = sessionData.rapportLevel.toFixed(2);
            
            const topics = ['introduction', 'business_model', 'market_opportunity', 'traction_metrics', 'team_execution', 'funding_vision'];
            const currentIndex = topics.indexOf(sessionData.currentTopic);
            const progress = Math.round((currentIndex / topics.length) * 100);
            
            document.getElementById('progressPercent').textContent = `${progress}%`;
            document.getElementById('progressFill').style.width = `${progress}%`;
            
            const insights = Object.keys(analysis.insights || {});
            document.getElementById('keyInsights').textContent = insights.length > 0 ? insights.join(', ') : 'None yet';
        }

        // Stop interview
        function stopInterview() {
            interviewActive = false;
            isListening = false;
            isSpeaking = false;
            
            if (recognition) {
                recognition.stop();
            }
            
            if (synthesis) {
                synthesis.cancel();
            }
            
            updateStatus('‚úÖ Interview Completed!', 'status-waiting');
            
            document.getElementById('startBtn').disabled = false;
            document.getElementById('speakBtn').disabled = true;
            document.getElementById('stopBtn').disabled = true;
            
            // Show final summary
            setTimeout(() => {
                const summary = `üéâ Interview Summary:\n- Total Exchanges: ${Math.floor(sessionData.conversationHistory.length / 2)}\n- Final Rapport: ${sessionData.rapportLevel.toFixed(2)}\n- Topics Covered: ${sessionData.currentTopic.replace('_', ' ')}\n\n‚úÖ Interview data ready for investment evaluation!`;
                addMessage('interviewer', summary);
            }, 2000);
        }

        // Initialize when page loads
        window.onload = function() {
            updateStatus('üé§ Ready to start voice interview!', 'status-waiting');
            
            // Load voices
            if (speechSynthesis.onvoiceschanged !== undefined) {
                speechSynthesis.onvoiceschanged = function() {
                    console.log('Voices loaded:', speechSynthesis.getVoices().length);
                };
            }
        };
    </script>
</body>
</html>
